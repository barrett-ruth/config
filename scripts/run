#!/bin/sh

[ "$1" ] || exit

file="$1"
shift

ext="${file##*.}"

[ "$*" ] && args="$* "

case "$ext" in
c | cc | cpp)
    [ "$ext" = c ] && comp=gcc || comp=g++
    [ "$args" ] || args="-Wall -Werror -Wextra -Wshadow -Wconversion -Wdouble-promotion -Wformat=2 -Wformat-truncation -Wundef "

    cmd="$comp $args$file && ./a.out && rm a.out"
    ;;
py)
    [ "$VIRTUAL_ENV" ] && py="$VIRTUAL_ENV/bin/python" || py=python
    cmd="$(which $py) $args$file"
    ;;
js)
    node "$file"
    ;;
ts)
    ts-node "$file"
    ;;
*)
    cmd="$file $*"
    ;;
esac

echo " > $cmd"
eval "$cmd"
